@startuml Sequence_Diagram
' ============================================================================
' SEQUENCE DIAGRAM - SISTEM INFORMASI KEDISIPLINAN SISWA SMK NEGERI 1
' ============================================================================
' Author: System Documentation
' Version: 2.0 (PlantUML)
' Date: 27 Desember 2024
' ============================================================================

' === GLOBAL STYLING ===
skinparam backgroundColor #FEFEFE
skinparam shadowing false
skinparam defaultFontName "Segoe UI"
skinparam defaultFontSize 10

' === SEQUENCE STYLING ===
skinparam sequence {
    ArrowColor #455A64
    ArrowFontColor #37474F
    LifeLineBorderColor #78909C
    LifeLineBackgroundColor #ECEFF1
    ParticipantBorderColor #37474F
    ParticipantBackgroundColor #FFFFFF
    ParticipantFontColor #212121
    ActorBorderColor #1976D2
    ActorBackgroundColor #E3F2FD
    BoxBorderColor #9E9E9E
    BoxBackgroundColor #FAFAFA
    DividerBackgroundColor #E0E0E0
    GroupBorderColor #616161
}

' === NOTE STYLING ===
skinparam note {
    BackgroundColor #FFF9C4
    BorderColor #FBC02D
}

autonumber

' ============================================================================
' SEQUENCE 1: LOGIN PROCESS
' ============================================================================

title **SD-01: Proses Login & Autentikasi**

actor "User" as USER
box "Frontend" #E3F2FD
    participant "Browser" as BROWSER
end box
box "Application Layer" #E8F5E9
    participant "LoginController" as LC
    participant "AuthMiddleware" as AM
end box
box "Data Layer" #FFF3E0
    participant "User Model" as UM
    participant "Session" as SS
    database "MySQL" as DB
end box

USER -> BROWSER : Akses aplikasi
BROWSER -> LC : GET /login
LC --> BROWSER : Return login form

USER -> BROWSER : Input username & password
BROWSER -> LC : POST /login

LC -> UM : findByUsername(username)
UM -> DB : SELECT * FROM users WHERE username=?
DB --> UM : User record
UM --> LC : User object

alt Password Valid
    LC -> LC : Hash::check(password)
    LC -> SS : create session
    LC -> AM : Get user role
    AM -> DB : SELECT role FROM roles WHERE id=?
    DB --> AM : role.nama_role
    
    alt Role = Kepala Sekolah
        LC --> BROWSER : Redirect /dashboard/kepsek
    else Role = Waka Kesiswaan
        LC --> BROWSER : Redirect /dashboard/admin
    else Role = Kaprodi
        LC --> BROWSER : Redirect /dashboard/kaprodi
    else Role = Wali Kelas
        LC --> BROWSER : Redirect /dashboard/walikelas
    else Role = Guru
        LC --> BROWSER : Redirect /pelanggaran/catat
    else Role = Wali Murid
        LC --> BROWSER : Redirect /dashboard/wali_murid
    end
    
    BROWSER --> USER : Display Dashboard
else Password Invalid
    LC --> BROWSER : Return error message
    BROWSER --> USER : "Username/Password salah"
end

@enduml
